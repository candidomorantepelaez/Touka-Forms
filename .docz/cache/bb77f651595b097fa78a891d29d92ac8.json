{"remainingRequest":"/home/kan/desarrollo/proyectos/components/touka-forms/node_modules/babel-loader/lib/index.js?{\"presets\":[\"@babel/preset-env\",\"@babel/react\",[\"/home/kan/desarrollo/proyectos/components/touka-forms/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[\"@babel/plugin-proposal-class-properties\",[\"module-resolver\",{\"root\":[\"./src\"]}],[\"/home/kan/desarrollo/proyectos/components/touka-forms/node_modules/docz-core/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}]],\"babelrc\":false,\"cacheCompression\":true,\"compact\":true}!/home/kan/desarrollo/proyectos/components/touka-forms/src/components/form.jsx","dependencies":[{"path":"/home/kan/desarrollo/proyectos/components/touka-forms/src/components/form.jsx","mtime":1549052216147},{"path":"/home/kan/desarrollo/proyectos/components/touka-forms/node_modules/cache-loader/dist/cjs.js","mtime":1547306037965},{"path":"/home/kan/desarrollo/proyectos/components/touka-forms/node_modules/babel-loader/lib/index.js","mtime":1547246468683}],"contextDependencies":[],"result":["function _typeof(obj){if(typeof Symbol===\"function\"&&typeof Symbol.iterator===\"symbol\"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol===\"function\"&&obj.constructor===Symbol&&obj!==Symbol.prototype?\"symbol\":typeof obj;};}return _typeof(obj);}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)===\"object\"||typeof call===\"function\")){return call;}return _assertThisInitialized(self);}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function\");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return self;}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}import React,{Component}from'react';import{isNil,omit}from'ramda';import FormContextManager from\"../managers/form-context-manager\";import FormContext from\"../contexts/form-context\";var Form=/*#__PURE__*/function(_Component){_inherits(Form,_Component);function Form(props){var _this;_classCallCheck(this,Form);_this=_possibleConstructorReturn(this,_getPrototypeOf(Form).call(this,props));_this.formManager=new FormContextManager(props.initialValue);_this.onFieldChange=_this.onFieldChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));_this.onFieldMount=_this.onFieldMount.bind(_assertThisInitialized(_assertThisInitialized(_this)));_this.handlerOnValidate=_this.handlerOnValidate.bind(_assertThisInitialized(_assertThisInitialized(_this)));_this.handlerSubmit=_this.handlerSubmit.bind(_assertThisInitialized(_assertThisInitialized(_this)));_this.state={initialValue:props.initialValue,fields:{},errorsInForm:[]};return _this;}_createClass(Form,[{key:\"onFieldChange\",value:function onFieldChange(fieldData){var _this2=this;this.setState({fields:this.formManager.onFieldChange(fieldData)},function(){return _this2.handlerOnValidate();});}},{key:\"onFieldMount\",value:function onFieldMount(fieldData){this.setState({fields:this.formManager.onFieldMount(fieldData)});}},{key:\"handlerOnValidate\",value:function handlerOnValidate(){var _this3=this;var onValidate=this.props.onValidate;var result=onValidate(this.formManager.getValues());var newFieldvalue=this.formManager.onValidationForm(result);var newErrorsInForm=this.formManager.globalErrorsInForm;return new Promise(function(resolve){_this3.setState({fields:newFieldvalue,errorsInForm:newErrorsInForm},function(){return resolve();});});}},{key:\"handlerSubmit\",value:function handlerSubmit(evt){var _this4=this;var onSubmit=this.props.onSubmit;if(!isNil(evt)){evt.preventDefault();}this.handlerOnValidate().then(function(){var value=_this4.formManager.onSubmitForm();if(!isNil(value)){onSubmit(value);}});}},{key:\"render\",value:function render(){var _this5=this;var children=this.props.children;var _this$state=this.state,initialValue=_this$state.initialValue,errorsInForm=_this$state.errorsInForm,fields=_this$state.fields;var safeProps=omit(['initialValue','onValidate','onSubmit'],this.props);return React.createElement(FormContext.Provider,{value:{initialValue:initialValue,globalErrors:errorsInForm,fields:fields,onFieldChange:this.onFieldChange,onFieldMount:this.onFieldMount,onSubmit:this.handlerSubmit}},React.createElement(\"form\",Object.assign({onSubmit:function onSubmit(evt){return _this5.handlerSubmit(evt);}},safeProps),children));}}]);return Form;}(Component);_defineProperty(Form,\"defaultProps\",{initialValue:{},onValidate:function onValidate(){return null;}});export default Form;Form.__docgenInfo={\"description\":\"\",\"methods\":[{\"name\":\"onFieldChange\",\"docblock\":null,\"modifiers\":[],\"params\":[{\"name\":\"fieldData\",\"type\":null}],\"returns\":null},{\"name\":\"onFieldMount\",\"docblock\":null,\"modifiers\":[],\"params\":[{\"name\":\"fieldData\",\"type\":null}],\"returns\":null},{\"name\":\"handlerOnValidate\",\"docblock\":null,\"modifiers\":[],\"params\":[],\"returns\":null},{\"name\":\"handlerSubmit\",\"docblock\":null,\"modifiers\":[],\"params\":[{\"name\":\"evt\",\"type\":null}],\"returns\":null}],\"displayName\":\"Form\",\"props\":{\"initialValue\":{\"defaultValue\":{\"value\":\"{}\",\"computed\":false},\"type\":{\"name\":\"shape\",\"value\":{}},\"required\":false,\"description\":\"define el valor inicial del formulario, en caso de tener conflicto con el\\nvalor inicial de un input en concreto, tiene preferencia este valor.\"},\"onValidate\":{\"defaultValue\":{\"value\":\"() => null\",\"computed\":false},\"type\":{\"name\":\"func\"},\"required\":false,\"description\":\"funcion que se ejecuta en cada cambio de valor del formulario.\\nrecibe como parametro el nuevo valor, en caso de error se debe\\nretornar un objeto error.\"},\"onSubmit\":{\"type\":{\"name\":\"func\"},\"required\":true,\"description\":\"funcion que se ejecuta al enviar el formulario,\\nrecibe como parametro un objecto con el valor del formulario.\"},\"children\":{\"type\":{\"name\":\"node\"},\"required\":true,\"description\":\"son los hijos del componente Form\"}}};",{"version":3,"sources":["/home/kan/desarrollo/proyectos/components/touka-forms/src/components/form.jsx"],"names":["React","Component","isNil","omit","FormContextManager","FormContext","Form","props","formManager","initialValue","onFieldChange","bind","onFieldMount","handlerOnValidate","handlerSubmit","state","fields","errorsInForm","fieldData","setState","onValidate","result","getValues","newFieldvalue","onValidationForm","newErrorsInForm","globalErrorsInForm","Promise","resolve","evt","onSubmit","preventDefault","then","value","onSubmitForm","children","safeProps","globalErrors"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport { isNil, omit } from 'ramda'\nimport FormContextManager from 'managers/form-context-manager'\nimport FormContext from 'contexts/form-context'\n\n\nclass Form extends Component {\n  static propTypes = {\n    /**\n     * define el valor inicial del formulario, en caso de tener conflicto con el\n     * valor inicial de un input en concreto, tiene preferencia este valor.\n     */\n    initialValue: PropTypes.shape({}),\n\n    /**\n     * funcion que se ejecuta al enviar el formulario,\n     * recibe como parametro un objecto con el valor del formulario.\n     */\n    onSubmit: PropTypes.func.isRequired,\n\n    /**\n     * son los hijos del componente Form\n     */\n    children: PropTypes.node.isRequired,\n\n    /**\n     * funcion que se ejecuta en cada cambio de valor del formulario.\n     * recibe como parametro el nuevo valor, en caso de error se debe\n     * retornar un objeto error.\n     *\n     */\n    onValidate: PropTypes.func,\n\n  }\n\n  static defaultProps = {\n    initialValue: {},\n    onValidate: () => null,\n  }\n\n  constructor(props) {\n    super(props)\n    this.formManager = new FormContextManager(props.initialValue)\n    this.onFieldChange = this.onFieldChange.bind(this)\n    this.onFieldMount = this.onFieldMount.bind(this)\n    this.handlerOnValidate = this.handlerOnValidate.bind(this)\n    this.handlerSubmit = this.handlerSubmit.bind(this)\n    this.state = {\n      initialValue: props.initialValue,\n      fields: {},\n      errorsInForm: [],\n    }\n  }\n\n  onFieldChange(fieldData) {\n    this.setState({\n      fields: this.formManager.onFieldChange(fieldData),\n    }, () => this.handlerOnValidate())\n  }\n\n  onFieldMount(fieldData) {\n    this.setState({ fields: this.formManager.onFieldMount(fieldData) })\n  }\n\n  handlerOnValidate() {\n    const { onValidate } = this.props\n    const result = onValidate(this.formManager.getValues())\n    const newFieldvalue = this.formManager.onValidationForm(result)\n    const newErrorsInForm = this.formManager.globalErrorsInForm\n    return new Promise((resolve) => {\n      this.setState({\n        fields: newFieldvalue,\n        errorsInForm: newErrorsInForm,\n      }, () => resolve())\n    })\n  }\n\n  handlerSubmit(evt) {\n    const { onSubmit } = this.props\n    if (!isNil(evt)) {\n      evt.preventDefault()\n    }\n    this.handlerOnValidate().then(() => {\n      const value = this.formManager.onSubmitForm()\n      if (!isNil(value)) {\n        onSubmit(value)\n      }\n    })\n  }\n\n  render() {\n    const { children } = this.props\n    const {\n      initialValue, errorsInForm, fields,\n    } = this.state\n    const safeProps = omit(['initialValue', 'onValidate', 'onSubmit'], this.props)\n    return (\n      <FormContext.Provider\n        value={{\n          initialValue,\n          globalErrors: errorsInForm,\n          fields,\n          onFieldChange: this.onFieldChange,\n          onFieldMount: this.onFieldMount,\n          onSubmit: this.handlerSubmit,\n        }}\n      >\n        <form\n          onSubmit={evt => this.handlerSubmit(evt)}\n          {...safeProps}\n        >\n          {children}\n        </form>\n      </FormContext.Provider>\n    )\n  }\n}\n\nexport default Form\n"]}]}